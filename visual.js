var addJSLibraries=!0,VisualJS={version:"0.10.7",show:!0,old:!1,fixed:null,width:500,bwidth:500,height:500,normal:500,scripts:[],map:{},container:{},pub:{},func:{},callback:null,getSize:function(e){var t=VisualJS.setup,i=t.html,a=i.heading,n=i.footer,l=window,s=document,r=s.documentElement,o=s.getElementsByTagName("body")[0],u=s.getElementById(e),d=u.getElementsByTagName(a)[0].clientHeight,c=u.getElementsByTagName(n)[0].clientHeight,p=l.innerHeight||r.clientHeight||o.clientHeight,h=0;return d||(h+=11),c||(h+=11),"undefined"!=typeof p&&"undefined"!=typeof d&&"undefined"!=typeof c&&(null===VisualJS.fixed?(VisualJS.bwidth=l.innerWidth||r.clientWidth||o.clientWidth,VisualJS.width=VisualJS.bwidth-t.padding.w,VisualJS.height=p-t.padding.h-d-c+h):(VisualJS.bwidth=r.clientWidth||o.clientWidth,VisualJS.width=VisualJS.fixed[0]-t.padding.w,VisualJS.height=VisualJS.fixed[1]-t.padding.h-d-c+h)),VisualJS.visualsize=VisualJS.width<VisualJS.normal?t.mini:t.normal,VisualJS.width>10&&VisualJS.height>10},iframe:function(e,t){addJSLibraries=!0;var i=VisualJS.setup,a="string"==typeof e.clas?e.clas:i.clas,n='<!DOCTYPE html>\n<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->\n<!--[if IE 7]><html class="lt-ie9 lt-ie8"> <![endif]-->\n<!--[if IE 8]><html class="lt-ie9"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>',l=function(){var t=document,i=t.createElement("iframe"),a=t.getElementById(e.id);return i.frameBorder="0",i.scrolling="no",a.parentNode.insertBefore(i,a.nextSibling),i},s=function(e,t){if("undefined"!=typeof e){var i;e.contentDocument?i=e.contentDocument:e.contentWindow?i=e.contentWindow.document:window.frames[e.name]&&(i=window.frames[e.name].document),i&&(i.open(),i.write(t),i.close())}};"string"==typeof t&&(n+=-1===t.indexOf("{")?'<link href="'+t+'" rel="stylesheet" type="text/css"/>':'<style type="text/css">'+t+"</style>"),n+='<script type="text/javascript" src="'+VisualJS.setup.main.visual+'"></script>',n+='<script type="text/javascript" src="'+VisualJS.setup.main.setup+'"></script>',n+='<script type="text/javascript" src="'+VisualJS.setup.main.lazy+'"></script>',n+='</head><body><div id="'+e.id+'" class="'+a+'"></div><script>window.setTimeout(function(){visual('+JSON.stringify(e)+");},1);</script></body></html>",s(l(),n)},compare:function(e){var t,i=VisualJS.setup,a=VisualJS.setup.separator,n="string"==typeof e.id?e.id:i.id,l="[object Array]"===Object.prototype.toString.call(e.css)?0===e.css.length?["",""]:1===e.css.length?[e.css[0],e.css[0]]:e.css:[e.css,e.css],s=document,r=s.createElement(i.html.heading),o=s.createElement(i.html.footer),u=s.getElementById(n),d=s.createElement("div"),c=s.createElement("style"),p=function(){if(VisualJS.getSize(n)){var t=VisualJS.height+("string"==typeof e.footer&&""!==e.footer?14:0),l=VisualJS.width+i.margin,s="iframe{ float: left; width: "+Math.floor((l-a)/2-i.margin)+"px; height:"+t+"px; }";c.styleSheet?c.styleSheet.cssText=s:c.innerHTML=s,d.style.height=t+"px"}},r=$("h1",{text:"string"==typeof e.title?e.title:""}),h=$("div",{id:"filters"});o.innerHTML="string"==typeof e.footer?e.footer:"",o.style.clear="both",u.appendChild(r),u.appendChild(h),u.appendChild(o),s.getElementsByTagName("head")[0].appendChild(c),d.style.width=a+"px","styleFloat"in d.style?d.style.styleFloat="left":d.style.cssFloat="left";for(var f=0;2>f;f++)t=s.createElement("span"),"string"!=typeof e.load[f].id&&(e.load[f].id=i.compareids[f]),t.id=e.load[f].id,u.insertBefore(t,o),VisualJS.iframe(e.load[f],l[f]);u.insertBefore(d,t),p(),"undefined"!=typeof window.onorientationchange?window.onorientationchange=p:window.onresize=p},load:function(e){var t=function(e){var t=JSON.parse(e.data),i=function(t){e.source.postMessage(JSON.stringify(t),"*")};if("undefined"==typeof t.action)i({type:"error",data:[{id:"400",label:'"action" is required.'}]});else if("send"===t.action){var a=t.id||VisualJS.id,n=VisualJS.container[a]||VisualJS.container[a];if(n){if("cmap"===n.type&&!n.data[0].hasOwnProperty("label")){for(var l=[],s=VisualJS.map[n.by],r=s.features.length;r--;)l[s.features[r].properties[s.id]]=s.features[r].properties[s.label];for(var o=n.data,u=o.length;u--;)o[u].label=l[o[u].id]}i(n)}else i({type:"error",data:[{id:"404",label:'A visualisation with the specified "id" was not found'}]})}else i({type:"error",data:[{id:"400",label:'"action" value is not correct.'}]})};if("undefined"==typeof VisualJS.setup&&window.alert("Visual: Setup not found (visual.setup.js)!"),"[object Array]"!==Object.prototype.toString.call(e))VisualJS.get(e);else for(var i=0,a=e.length;a>i;i++)VisualJS.get(e[i]);VisualJS.container[VisualJS.id].listen&&(window.addEventListener?addEventListener("message",t,!1):document.attachEvent("onmessage",t))},get:function(e){for(var t=VisualJS.setup,i=t.html,a=t.canvas,n=i.heading,l=i.filters,s=i.footer,r=VisualJS.old||t.func.old("ie9"),o=function(e){return"undefined"!=typeof e&&"[object Array]"===Object.prototype.toString.call(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<e[1]?!0:!1},u=function(t,i,a){"string"==typeof t?typeof e[t]!==i&&(e[t]=a[t]):2==t.length&&typeof e[t[0]][t[1]]!==i?e[t[0]][t[1]]=a[t[0]][t[1]]:3==t.length&&typeof e[t[0]][t[1]][[t[2]]]!==i&&(e[t[0]][t[1]][[t[2]]]=a[t[0]][t[1]][[t[2]]])},d=[["show","boolean",VisualJS],["callback","function",VisualJS],["id","string",t],["listen","boolean",t],["dec","number",a],["autoheading","boolean",a],["legend","object",a],[["legend","show"],"boolean",a],[["legend","columns"],"number",a],[["legend","bottom"],"boolean",a],["grid","object",a],[["grid","border"],"number",a],[["grid","shadow"],"number",a],[["grid","line"],"number",a],[["grid","point"],"number",a],["axis","object",a],[["axis","x"],"object",a],[["axis","x","show"],"boolean",a],[["axis","x","label"],"string",a],[["axis","y"],"object",a],[["axis","y","show"],"boolean",a],[["axis","y","label"],"string",a],["horizontal","boolean",a]],c=0;c<d.length;c++)u(d[c][0],d[c][1],d[c][2]);VisualJS.id=e.id,VisualJS.pub[VisualJS.id]={heading:null,legend:null},"object"==typeof e.fixed&&(VisualJS.fixed=e.fixed),"object"==typeof e.unit&&null!==e.unit?(u(["unit","label"],"string",a),u(["unit","symbol"],"string",a),u(["unit","position"],"string",a)):e.unit=a.unit,e.lang=e.lang||t.i18n.lang,"number"==typeof e.range||o(e.range)||(e.range=a.range.hasOwnProperty(e.type)&&"number"==typeof a.range[e.type]?a.range[e.type]:null),VisualJS.container[VisualJS.id]=e;var p,h="#"+VisualJS.id,f=h+" ."+t.canvasclass,g=VisualJS.container[VisualJS.id],b=function(){if(g.autoheading===!1)return g.title;var e,t=[],i=function(e,i){"string"==typeof e&&""!==e&&(i===!0&&(e='<span class="'+VisualJS.setup.nowrapclass+'">'+e+"</span>"),t.push(e))};if(null!==g.time&&"object"==typeof g.time){var a=V(g.time[0],VisualJS.id),n=V(g.time[g.time.length-1],VisualJS.id);e=a+"&ndash;"+n}else e=V(g.time,VisualJS.id);return i(g.title,!1),i(g.geo,!0),i(e,!0),m(t.join(". "))},y=function(){var e=!1;if("function"==typeof VisualJS.chart){w(),g.show&&VisualJS.chart();var t=function(){p(),null!==g.callback&&g.callback.call({id:VisualJS.id,chart:e,heading:VisualJS.pub[VisualJS.id].heading,legend:VisualJS.pub[VisualJS.id].legend})};"undefined"!=typeof window.onorientationchange?window.onorientationchange=t:window.onresize=t,e=!0}null!==g.callback&&g.callback.call({id:VisualJS.id,chart:e,heading:VisualJS.pub[VisualJS.id].heading,legend:VisualJS.pub[VisualJS.id].legend})},m=function(e){return String(e).replace(/&/g,"&")},S=function(e,t){return t&&e.exists.call()?!1:(VisualJS.scripts.push(e.js),!0)},J=function(e,t,i){var a="number"==typeof i&&""!==VisualJS.container[e].unit.label?" "+VisualJS.container[e].unit.label:"",n="number"==typeof i?VisualJS.container[e].unit.symbol:"",l=v(i,e),s=l!==VisualJS.setup.i18n.text.na[VisualJS.container[e].lang]?"end"===VisualJS.container[e].unit.position?l+a+(""!==n?" "+n:n):n+l+a:l;return t?"<strong>"+s+"</strong> "+t:s},v=function(e,t){if("undefined"==typeof e||null===e||isNaN(e))return VisualJS.setup.i18n.text.na[VisualJS.container[t].lang];if("number"==typeof e){for(var i=e.toFixed(VisualJS.container[t].dec),a=/(\d+)(\d{3})/,n=i.split("."),l=n[0],s=n.length>1?VisualJS.setup.i18n.text.dec[VisualJS.container[t].lang]+n[1]:"";a.test(l);)l=l.replace(a,"$1"+VisualJS.setup.i18n.text.k[VisualJS.container[t].lang]+"$2");return l+s}return""},V=function(e,t){var i;if(!e)return null;if(isNaN(e))return e;switch(e.length){case 5:i="quarter";break;case 6:i="month";break;default:return e}var a=VisualJS.setup.i18n.text[i];if("undefined"==typeof a)return e;var n=a[VisualJS.container[t].lang];if("undefined"==typeof n)return e;var l=n[e.slice(4)-1];return"undefined"==typeof l?e:l+" <span>"+e.slice(0,4)+"</span>"},x=function(e,t,i){var a=document.getElementById(VisualJS.setup.tooltipid),n=VisualJS.bwidth-VisualJS.setup.margin,l={};a.innerHTML=e,a.style.display="block";var s=a.clientWidth/2;l.x=t-s,l.y=i-a.clientHeight-5,t+s>n?l.x-=t+s-n:l.x<VisualJS.setup.margin&&(l.x+=VisualJS.setup.margin-l.x),l.y<VisualJS.setup.margin&&(l.y+=1.75*a.clientHeight),a.style.left=l.x+"px",a.style.top=l.y+"px"},w=function(){var e=document;if(!e.getElementById(VisualJS.setup.tooltipid)){var t=e.createElement("div");t.id=VisualJS.setup.tooltipid,t.style.display="none",e.body.appendChild(t)}},k=function(t,i,a,n,l){return"pie"===e.type?null:"rank"!==e.type&&"bar"!==e.type?e.horizontal?H||1===F.length?O[i][0]:t:H||1===F.length?O[t][1]:"pyram"===e.type?F[l.x<0?0:1].data[a.dataIndex][0]:O[a.dataIndex][1]:void 0},j=function(t,i,a,n){return"pie"===e.type?i[0][1]:"pyram"===e.type?Math.abs(t):"rank"===e.type?t:"tsbar"!==e.type&&"barline"!==e.type?i:e.horizontal?H||1===n.length?n[a.seriesIndex].data[i][0]:t:H||1===n.length?n[a.seriesIndex].data[t][1]:t};if("cmap"===e.type)if(r)document.getElementById(VisualJS.id).innerHTML="<p>"+t.i18n.text.oldbrowser[g.lang]+"</p>";else{if("string"!=typeof e.by)return;S(t.lib.maps,!0),S(t.lib.d3,!0),S(t.map[e.by],!0),VisualJS.chart=function(){var i=b(),a=VisualJS.map[e.by],r=a.area[0],o=a.area[1],u="object"==typeof e.grouped&&"object"==typeof e.grouped.label&&e.grouped.label.length>0&&e.data[0].hasOwnProperty("group"),d=e.data[0].hasOwnProperty("val"),c=u?e.grouped.label.length:d?t.colors.map.max:1,f=t.colorclassprefix,y=VisualJS.func.colors(t.colors.map.base,c,"fill",f,u&&"object"==typeof e.grouped.color&&e.grouped.color.length===e.grouped.label.length?e.grouped.color:[],VisualJS.id),S=d3.select(h),V=d3.geo[a.projection](),w="object"==typeof a.center&&"function"==typeof V.center?V.center(a.center):V,k=w.scale(a.scale).translate([r/2,o/2]),j=d3.geo.path().projection(k),z=d3.select("#"+t.tooltipid);(p=function(){if(S.html("<"+n+"></"+n+"><"+l+" id = 'filters'></"+l+"><"+s+"></"+s+">"),d3.select(h+" "+n).html(i),d3.select(h+" "+s).html(m(e.footer||"")),$("<div>",{id:"legend"}).addClass("legend").addClass("visual").appendTo(h+" "+s),VisualJS.getSize(VisualJS.id)){var p,b,V,w,k=VisualJS.id,E=d3.map(),W=d3.map(),L=e.data[0].hasOwnProperty("label"),M=[],I=function(){},q=function(){},T=VisualJS.height/o,B=VisualJS.width/r,C=Math.min(Math.round(r*T),VisualJS.width),F=Math.min(Math.round(o*B),VisualJS.height),O=Math.floor((VisualJS.width-C)/2),A=Math.floor((VisualJS.height-F)/2),H=B>T?T:B,N=S.insert("svg:svg",s).attr("width",C).attr("height",F);u?(p=d3.map(),I=function(e,t){e.set(t.id,t.group)},V=function(e,t,i){return f+(e.get(i[a.id])-1)},b=function(t,i){var n=e.grouped.label[t.get(i[a.id])-1],l=L?W.get(i[a.id]):i[a.label];return"undefined"!=typeof n&&(l+=" <em>"+n+"</em>"),l}):(d?(V=function(e,t,i,n,l){var s=t.get(i[a.id]);if("undefined"==typeof s)return"";if(n===l)return f+(c/2).toFixed(0);var r=d3.scale.quantize().domain([n,l]).range(d3.range(c).map(function(e){return f+e}));return r(s)},q=VisualJS.func.legend):V=function(e,t,i){return""!==t.get(i[a.id])?"":f+(c-1)},b=function(e,t){return L?W.get(t[a.id]):t[a.label]});for(var P=0,U=e.data,Y=U.length;Y>P;P++){var D=U[P];D.hasOwnProperty("val")?null!==D.val&&(E.set(D.id,D.val),M.push(D.val)):E.set(D.id,""),L&&W.set(D.id,D.label),I(p,D)}M.sort(function(e,t){return e-t});for(var R=Y/5,X=[M[0]],P=0;Y>P;P++)P>R&&(X.push(M[P]),R+=R);var w=[];if("number"==typeof g.range?(w.push(d3.quantile(M,20*g.range)),w.push(d3.quantile(M,40*g.range)),w.push(d3.quantile(M,60*g.range)),w.push(d3.quantile(M,80*g.range))):(w.push(g.range[0]),w.push(g.range[1])),N.style("margin-left",O+"px"),N.style("margin-top",A+"px"),N.style("margin-bottom",A+"px"),N.append("svg:g").attr("class",t.areaclass).attr("transform","scale("+H+")").selectAll("path").data(a.features).enter().append("svg:path").attr("class",function(e){return""===e.properties[a.id]||""===e.properties[a.label]||!d&&"undefined"==typeof E.get(e.properties[a.id])?f+"nohover":V(p,E,e.properties,w[0],w[w.length-1])}).attr("d",j).on("mousemove",function(e){""!==e.properties[a.id]&&""!==e.properties[a.label]&&(d||u||"undefined"!=typeof E.get(e.properties[a.id]))&&x(J(k,b(p,e.properties),E.get(e.properties[a.id])),d3.event.pageX,d3.event.pageY)}).on("mouseout",function(){return z.style("display","none")}),"undefined"!=typeof X){var G=[J(k,null,w[0]),J(k,null,w[1]),J(k,null,w[2]),J(k,null,w[3])],K=[y[y.length-25],y[y.length-50],y[y.length-75],y[0]],Q=[w[0]<X[0]||v(w[0],k)===v(X[0],k),w[1]<X[1]||v(w[1],k)===v(X[1],k),w[2]<X[2]||v(w[2],k)===v(X[2],k),w[3]>X[X.length-1]||v(w[3],k)===v(X[X.length-1],k)];VisualJS.pub[VisualJS.id].legend={color:K,text:G,symbol:[Q[0]?"==":"<=",Q[1]?"==":">",Q[2]?"==":">",Q[3]?"==":">="]},g.legend.show&&"object"==typeof a.legend&&q(G,K,N,z,a.area,a.legend,Q)}VisualJS.pub[VisualJS.id].heading=i,$("#visual h1").css("width",.9*$("body").outerWidth()),$("#visual p").css("width",.9*$("body").outerWidth())}})()}}else{var z;S(t.lib.jquery,!0)?(z=!1,S(t.lib.jquery.flot,!1),S(t.lib.jquery.flot.jFlotLabel,!1)):(z=S(t.lib.jquery.flot,!0)?!1:!0,S(t.lib.jquery.flot.jFlotLabel,z)),r&&S(t.lib.excanvas,!0);var E,W,L,M,I,q,T,B,C=function(){},F=[],O=[],A=[],H=e.stacked||!1,N=function(){if(g.autoheading){var i,a,n,l,s,r,o=e.time.length,u=e.data.length;if(null===e.data[0].val[0]){for(a=0,l=!0,s=[];o>a;a++){for(i=0;u>i;i++)l=l&&null===e.data[i].val[a];if(!l)break;s.push(l)}for(r=s.length,n=0;r>n;n++)if(s[n])for(e.time.shift(),i=0;u>i;i++)e.data[i].val.shift();o=e.time.length}if(null===e.data[0].val[o-1]){for(a=o,l=!0,s=[];a--;){for(i=0,u=e.data.length;u>i;i++)l=l&&null===e.data[i].val[a];if(!l)break;s.push(l)}for(n=s.length;n--;)if(s[n])for(e.time.pop(),i=0;u>i;i++)e.data[i].val.pop()}}var d=function(){};return H?S(t.lib.jquery.flot.stack,z):("tsbar"===e.type||"barline"===e.type)&&(S(t.lib.jquery.flot.orderbars,z),d=function(e){return e.bars}),C=function(t,i){VisualJS.ticks=[];var a,n;for(a=0,n=i.length;n>a;a++)e.horizontal?(O.push([a,i[a]]),VisualJS.ticks.push([i[a],a])):(O.push([a,i[a]]),VisualJS.ticks.push([a,i[a]]));for(a=0,n=t.length;n>a;a++){for(var l=[],s=t[a].val,r=s.length,o=0;r>o;o++)l.push(e.horizontal?[s[o],o]:[o,s[o]]);F.push("tsbar"!==e.type&&"barline"!==e.type||H||1===n?{label:t[a].label,data:l}:{label:t[a].label,data:l,bars:{show:!0,barWidth:.2,order:a+1,lineWidth:2}})}var u=F.length;for(a=0;u>a;a++)A.push({data:F[a].data,label:F[a].label.slice(0,40),bars:d(F[a]),shadowSize:g.grid.shadow});if("barline"===e.type&&!e.linesFirst){var c=F.shift();F.push(c),c=A.shift(),A.push(c)}W=e.legend.show},b()};Array.max=function(e){return Math.max.apply(Math,e)};var P=1,U=1,Y=1;switch(e.legend.bottom?Y=.9:U=.7,e.type){case"pyram":S(t.lib.jquery.flot.pyramid,z),I=!1,q=!1,T=b(),C=function(e,t,i){E=Math.max(Array.max(e[0].val),Array.max(e[1].val)),F[0]={label:e[0].label,data:[],pyramid:{direction:"L"}},F[1]={label:e[1].label,data:[]};for(var a=0,n=i.length;n>a;a++)F[0].data[a]=[i[a],e[0].val[a]],F[1].data[a]=[i[a],e[1].val[a]]},W=!0,L=!1,H=!1,M=!1,P=U;break;case"rank":var D=[];M=!1,I=!1,q=!0,T=b(),C=function(e){for(var t=[],i=0,a=e.length;a>i;i++){O[i]=[i,e[a-i-1][0]];var n=e[a-i-1][1];t.push(n),D[i]=[n,i]}F={data:D},E=Array.max(t)},W=!1,L=!1;break;case"bar":S(t.lib.jquery.flot.categories,z),I=!1,q=!0,T=b(),M=!1,C=function(e,t,i){var a,n;if("object"!=typeof i||null===i)for(n=e.length,a=0;n>a;a++)null!==e[a][1]&&F.push(["<span>"+e[a][0]+"</span>",e[a][1]]);else if("number"==typeof e[0])for(n=i.length,a=0;n>a;a++)null!==e[a]&&F.push(['<span">'+i[a]+"</span>",e[a]]);W=F.length>1},L=!0;break;case"tsline":T=N(),L=null,I=!0,q=!1,M=!0,P=U;break;case"barline":case"tsbar":T=N(),L=e.stacked,I=!1,q=!0,M=!1,P=U;break;case"pie":S(t.lib.jquery.flot.pie,z);var D=[];T=b(),L=null,I=!1,q=!1,M=!1,B=!0,C=function(e){for(var i=[],a=0,n=e.length;n>a;a++){var l=e[n-a-1][1];i.push(l),D.push({label:e[n-a-1][0],data:l,color:t.colors.series[a%t.colors.series.leght]})}D.sort(function(e,t){return e?t?t.data-e.data:-1:1}),F={data:D},E=Array.max(i)},P=U}VisualJS.chart=function(){C(e.data,e.time,e.by),$.fn.UseTooltip=function(i){var a=[];$(this).bind("plothover",function(n,l,s){if(s){if(a!=[s.seriesIndex,s.dataIndex]){a=[s.seriesIndex,s.dataIndex];var r=s.datapoint[0],o=s.datapoint[1],u="bar"!==e.type?s.series.label:F[r][0],d="rank"!==e.type?u:O[o][1],c=k(r,o,s,d,l),p=j(r,o,s,F);x(J(i,c?d+" ("+c+")":d,p),l.pageX,l.pageY)}}else $("#"+t.tooltipid).hide(),a=[]})},W=g.legend&&W;var i={colors:t.colors.series,series:{stack:L,bars:{show:q,barWidth:.7,align:"center",fill:.9},lines:{show:M,lineWidth:g.grid.line},points:{show:I,radius:g.grid.point},pie:{show:B,radius:1,label:{show:!0,radius:.75,formatter:function(e,t){return"<div style='font-size:150%; text-align:center; padding:2px; color:white;'>"+Math.round(t.percent)+"%</div>"},background:{opacity:.5}},combine:{color:"#ff6a6a",threshold:e.combineThreshold,label:t.i18n.text.other[e.lang]}}},legend:{show:W,container:"#legend",noColumns:e.legend.bottom?e.legend.columns?e.legend.columns:6:1},grid:{borderWidth:g.grid.border,hoverable:!0,clickable:!1,mouseActiveRadius:10},xaxis:{show:g.axis.x.show,axisLabel:g.axis.x.label,axisLabelUseCanvas:!0},yaxis:{min:g.forceYAxisMinValue,show:g.axis.y.show,axisLabel:g.axis.y.label,axisLabelUseCanvas:!0}},a=function(t,i,a){i.yaxis.tickFormatter=function(e){return v(e,t)};var n=VisualJS.width/a,l=[],s="01",r=$(".visual p").css("fontSize").replace(/[^0-9.]/g,"");switch(e.horizontal||"number"==typeof g.range||null===g.range?e.horizontal&&(i.yaxis.ticks=VisualJS.height/a>11?O.slice(0):0):(i.yaxis.min=g.range[0],i.yaxis.max=g.range[1]),VisualJS.ticks[0][1].length){case 4:if(30>n){var o=n>15?2:n>8?3:4;for(c=0;a>c;c++)l[c]=c%o?[O[c][0],""]:[O[c][0],O[c][1]];i.xaxis.ticks=l}else i.xaxis.ticks=O;break;case 5:s="1";case 6:if(35>n){for(c=0;a>c;c++)l[c]=VisualJS.ticks[c][1].slice(4)!==s?[VisualJS.ticks[c][0],""]:[VisualJS.ticks[c][0],VisualJS.ticks[c][1].slice(0,4)],O[c][1]=V(VisualJS.ticks[c][1],VisualJS.id);i.xaxis.ticks=l}else{for(c=0;a>c;c++)O[c][1]=V(VisualJS.ticks[c][1],VisualJS.id);i.xaxis.ticks=O}break;default:if(!e.horizontal)if(a>5){var u=(a/(n/(r/VisualJS.ticks[0][1].length))+1).toFixed(0);for(c=0;a>c;c++)l[c]=c%u!==0?[VisualJS.ticks[c][0],""]:[VisualJS.ticks[c][0],VisualJS.ticks[c][1]],O[c][1]=V(VisualJS.ticks[c][1],VisualJS.id);i.xaxis.ticks=l}else i.xaxis.ticks=O}return i};(p=function(){var r,o=VisualJS.id,u=O.length;$(h).html("<"+n+"></"+n+"><"+s+"></"+s+">"),$(h+" "+n).html(T),$(h+" "+s).html(m(e.footer||"")),$("#legend").remove();var d=$("<div>",{id:"legend"});if(e.legend.bottom?d.addClass("legendBottom").addClass("visual").insertBefore(h+" "+s):d.addClass("legendRight").addClass("visual").prependTo("body"),VisualJS.getSize(o)){$(h+" "+n).after('<div class="'+t.canvasclass+" "+VisualJS.visualsize+'" style="width: '+VisualJS.width*P+"px; height: "+VisualJS.height*Y+'px;"></div>'),$(h+" "+n).after("<"+l+' id="filters"></'+l+">");var c;switch(e.type){case"pyram":i.series.pyramid={show:!0,barWidth:1},i.yaxis.show=VisualJS.height/F[0].data.length>11?g.axis.y:!1,i.xaxis.max="number"==typeof g.range?E*g.range:g.range[1],i.xaxis.tickFormatter=function(e){return v(e,o)},c=$.plot(f,F,i);break;case"rank":i.series.bars.horizontal=!0,i.yaxis.ticks=VisualJS.height/u>11?O.slice(0):0,"number"==typeof g.range?i.xaxis.max=E*g.range:(i.xaxis.min=g.range[0],i.xaxis.max=g.range[1]),i.xaxis.tickFormatter=function(e){return v(e,o)},i.yaxis.autoscaleMargin=0,i.series.bars.barWidth=.5,c=$.plot(f,[F],i);break;case"bar":i.xaxis.mode="categories",i.xaxis.tickLength=0,i.yaxis.tickFormatter=function(e){return v(e,o)},"number"!=typeof g.range&&null!==g.range&&(i.yaxis.min=g.range[0],i.yaxis.max=g.range[1]),c=$.plot(f,[F],i);break;case"pie":$.plot(f,F.data,i);break;case"tsline":i=a(o,i,u),i.grid.markings=[{color:"#999",lineWidth:1,yaxis:{from:0,to:0}}],c=$.plot(f,A,i);break;case"barline":i=a(o,i,u);var p=function(e){return lineOpts={stack:!1,label:e.label,data:e.data,lines:{show:!0},bars:{show:!1},points:{show:!0,radius:3},yaxis:2}},b=e.linesFirst?A.slice(1,A.length):A.pop();if(b.length){A=[A.shift()];for(var r=0;r<b.length;r++)A.push(p(b[r]))}else A.push(p(b));i.yaxes=[{min:0},{min:0,alignTicksWithAxis:1,position:"right",tickFormatter:function(e){return v(e,o)}}],c=$.plot(f,A,i);break;case"tsbar":i=a(o,i,u),e.horizontal&&(i.series.bars.horizontal=e.horizontal),c=$.plot(f,A,i)}$("#visual #filters").css("width",.9*$("#visual .VisualJScanvas").outerWidth()),$("#visual h1").css("width",.9*$("#visual .VisualJScanvas").outerWidth()),$("#visual p").css("width",.9*$("#visual .VisualJScanvas").outerWidth()),e.legend.bottom?$("#legend").css("width",.95*$("body").outerWidth()):($("#legend").css("height",.9*$("#visual .VisualJScanvas").outerHeight()),$("#legend").css("width",.85*($("body").outerWidth()-$("#visual .VisualJScanvas").outerWidth()))),$(f).UseTooltip(VisualJS.id),VisualJS.pub[VisualJS.id].heading=T}})()}}VisualJS.scripts.length&&"object"==typeof LazyLoad&&addJSLibraries?(LazyLoad.js(VisualJS.scripts,y),addJSLibraries=!1):y()}};if("function"!=typeof visual)var visual=VisualJS.load;
var VisualJS={version:"0.10.7",show:!0,old:!1,fixed:null,width:500,bwidth:500,height:500,normal:500,scripts:[],map:{},container:{},pub:{},func:{},callback:null,getSize:function(e){var t=VisualJS.setup,i=t.html,a=i.heading,n=i.footer,l=window,r=document,s=r.documentElement,o=r.getElementsByTagName("body")[0],u=r.getElementById(e),d=u.getElementsByTagName(a)[0].clientHeight,c=u.getElementsByTagName(n)[0].clientHeight,p=l.innerHeight||s.clientHeight||o.clientHeight,f=0;return d||(f+=11),c||(f+=11),"undefined"!=typeof p&&"undefined"!=typeof d&&"undefined"!=typeof c&&(null===VisualJS.fixed?(VisualJS.bwidth=l.innerWidth||s.clientWidth||o.clientWidth,VisualJS.width=VisualJS.bwidth-t.padding.w,VisualJS.height=p-t.padding.h-d-c+f):(VisualJS.bwidth=s.clientWidth||o.clientWidth,VisualJS.width=VisualJS.fixed[0]-t.padding.w,VisualJS.height=VisualJS.fixed[1]-t.padding.h-d-c+f)),VisualJS.visualsize=VisualJS.width<VisualJS.normal?t.mini:t.normal,VisualJS.width>10&&VisualJS.height>10},iframe:function(e,t){var i=VisualJS.setup,a="string"==typeof e.clas?e.clas:i.clas,n='<!DOCTYPE html>\n<!--[if lt IE 7]><html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->\n<!--[if IE 7]><html class="lt-ie9 lt-ie8"> <![endif]-->\n<!--[if IE 8]><html class="lt-ie9"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>',l=function(){var t=document,i=t.createElement("iframe"),a=t.getElementById(e.id);return i.frameBorder="0",i.scrolling="no",a.parentNode.insertBefore(i,a.nextSibling),i},r=function(e,t){if("undefined"!=typeof e){var i;e.contentDocument?i=e.contentDocument:e.contentWindow?i=e.contentWindow.document:window.frames[e.name]&&(i=window.frames[e.name].document),i&&(i.open(),i.write(t),i.close())}};"string"==typeof t&&(n+=-1===t.indexOf("{")?'<link href="'+t+'" rel="stylesheet" type="text/css"/>':'<style type="text/css">'+t+"</style>"),n+='<script type="text/javascript" src="'+VisualJS.setup.main.visual+'"></script>',n+='<script type="text/javascript" src="'+VisualJS.setup.main.setup+'"></script>',n+='<script type="text/javascript" src="'+VisualJS.setup.main.lazy+'"></script>',n+='</head><body><div id="'+e.id+'" class="'+a+'"></div><script>window.setTimeout(function(){visual('+JSON.stringify(e)+");},1);</script></body></html>",r(l(),n)},compare:function(e){var t,i=VisualJS.setup,a=VisualJS.setup.separator,n="string"==typeof e.id?e.id:i.id,l="[object Array]"===Object.prototype.toString.call(e.css)?0===e.css.length?["",""]:1===e.css.length?[e.css[0],e.css[0]]:e.css:[e.css,e.css],r=document,s=r.createElement(i.html.heading),o=r.createElement(i.html.footer),u=r.getElementById(n),d=r.createElement("div"),c=r.createElement("style"),p=function(){if(VisualJS.getSize(n)){var t=VisualJS.height+("string"==typeof e.footer&&""!==e.footer?14:0),l=VisualJS.width+i.margin,r="iframe{ float: left; width: "+Math.floor((l-a)/2-i.margin)+"px; height:"+t+"px; }";c.styleSheet?c.styleSheet.cssText=r:c.innerHTML=r,d.style.height=t+"px"}};s.innerHTML="string"==typeof e.title?e.title:"",o.innerHTML="string"==typeof e.footer?e.footer:"",o.style.clear="both",u.appendChild(s),u.appendChild(o),r.getElementsByTagName("head")[0].appendChild(c),d.style.width=a+"px","styleFloat"in d.style?d.style.styleFloat="left":d.style.cssFloat="left";for(var f=0;2>f;f++)t=r.createElement("span"),"string"!=typeof e.load[f].id&&(e.load[f].id=i.compareids[f]),t.id=e.load[f].id,u.insertBefore(t,o),VisualJS.iframe(e.load[f],l[f]);u.insertBefore(d,t),p(),"undefined"!=typeof window.onorientationchange?window.onorientationchange=p:window.onresize=p},load:function(e){var t=function(e){var t=JSON.parse(e.data),i=function(t){e.source.postMessage(JSON.stringify(t),"*")};if("undefined"==typeof t.action)i({type:"error",data:[{id:"400",label:'"action" is required.'}]});else if("send"===t.action){var a=t.id||VisualJS.id,n=VisualJS.container[a]||VisualJS.container[a];if(n){if("cmap"===n.type&&!n.data[0].hasOwnProperty("label")){for(var l=[],r=VisualJS.map[n.by],s=r.features.length;s--;)l[r.features[s].properties[r.id]]=r.features[s].properties[r.label];for(var o=n.data,u=o.length;u--;)o[u].label=l[o[u].id]}i(n)}else i({type:"error",data:[{id:"404",label:'A visualisation with the specified "id" was not found'}]})}else i({type:"error",data:[{id:"400",label:'"action" value is not correct.'}]})};if("undefined"==typeof VisualJS.setup&&window.alert("Visual: Setup not found (visual.setup.js)!"),"[object Array]"!==Object.prototype.toString.call(e))VisualJS.get(e);else for(var i=0,a=e.length;a>i;i++)VisualJS.get(e[i]);VisualJS.container[VisualJS.id].listen&&(window.addEventListener?addEventListener("message",t,!1):document.attachEvent("onmessage",t))},get:function(e){for(var t=VisualJS.setup,i=t.html,a=t.canvas,n=i.heading,l=i.footer,r=VisualJS.old||t.func.old("ie9"),s=function(e){return"undefined"!=typeof e&&"[object Array]"===Object.prototype.toString.call(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<e[1]?!0:!1},o=function(t,i,a){"string"==typeof t?typeof e[t]!==i&&(e[t]=a[t]):typeof e[t[0]][t[1]]!==i&&(e[t[0]][t[1]]=a[t[0]][t[1]])},u=[["show","boolean",VisualJS],["callback","function",VisualJS],["id","string",t],["listen","boolean",t],["dec","number",a],["autoheading","boolean",a],["legend","boolean",a],["grid","object",a],[["grid","border"],"number",a],[["grid","shadow"],"number",a],[["grid","line"],"number",a],[["grid","point"],"number",a],["axis","object",a],[["axis","x"],"boolean",a],[["axis","y"],"boolean",a]],d=0;d<u.length;d++)o(u[d][0],u[d][1],u[d][2]);VisualJS.id=e.id,VisualJS.pub[VisualJS.id]={heading:null,legend:null},"object"==typeof e.fixed&&(VisualJS.fixed=e.fixed),"object"==typeof e.unit&&null!==e.unit?(o(["unit","label"],"string",a),o(["unit","symbol"],"string",a),o(["unit","position"],"string",a)):e.unit=a.unit,e.lang=e.lang||t.i18n.lang,"number"==typeof e.range||s(e.range)||(e.range=a.range.hasOwnProperty(e.type)&&"number"==typeof a.range[e.type]?a.range[e.type]:null),VisualJS.container[VisualJS.id]=e;var c,p="#"+VisualJS.id,f=p+" ."+t.canvasclass,g=VisualJS.container[VisualJS.id],h=function(){if(g.autoheading===!1)return g.title;var e,t=[],i=function(e,i){"string"==typeof e&&""!==e&&(i===!0&&(e='<span class="'+VisualJS.setup.nowrapclass+'">'+e+"</span>"),t.push(e))};if(null!==g.time&&"object"==typeof g.time){var a=V(g.time[0],VisualJS.id),n=V(g.time[g.time.length-1],VisualJS.id);e=a+"&ndash;"+n}else e=V(g.time,VisualJS.id);return i(g.title,!1),i(g.geo,!0),i(e,!0),m(t.join(". "))},y=function(){var e=!1;"function"==typeof VisualJS.chart&&(v(),g.show&&VisualJS.chart(),"undefined"!=typeof window.onorientationchange?window.onorientationchange=c:window.onresize=c,e=!0),null!==g.callback&&g.callback.call({id:VisualJS.id,chart:e,heading:VisualJS.pub[VisualJS.id].heading,legend:VisualJS.pub[VisualJS.id].legend})},m=function(e){return String(e).replace(/&amp;/g,"&")},b=function(e,t){return t&&e.exists.call()?!1:(VisualJS.scripts.push(e.js),!0)},S=function(e,t,i){var a="number"==typeof i&&""!==VisualJS.container[e].unit.label?" "+VisualJS.container[e].unit.label:"",n="number"==typeof i?VisualJS.container[e].unit.symbol:"",l=J(i,e),r=l!==VisualJS.setup.i18n.text.na[VisualJS.container[e].lang]?"end"===VisualJS.container[e].unit.position?l+a+(""!==n?" "+n:n):n+l+a:l;return t?"<strong>"+r+"</strong> "+t:r},J=function(e,t){if("undefined"==typeof e||null===e)return VisualJS.setup.i18n.text.na[VisualJS.container[t].lang];if("number"==typeof e){for(var i=e.toFixed(VisualJS.container[t].dec),a=/(\d+)(\d{3})/,n=i.split("."),l=n[0],r=n.length>1?VisualJS.setup.i18n.text.dec[VisualJS.container[t].lang]+n[1]:"";a.test(l);)l=l.replace(a,"$1"+VisualJS.setup.i18n.text.k[VisualJS.container[t].lang]+"$2");return l+r}return""},V=function(e,t){var i;if(!e)return null;if(isNaN(e))return e;switch(e.length){case 5:i="quarter";break;case 6:i="month";break;default:return e}var a=VisualJS.setup.i18n.text[i];if("undefined"==typeof a)return e;var n=a[VisualJS.container[t].lang];if("undefined"==typeof n)return e;var l=n[e.slice(4)-1];return"undefined"==typeof l?e:l+" <span>"+e.slice(0,4)+"</span>"},x=function(e,t,i){var a=document.getElementById(VisualJS.setup.tooltipid),n=VisualJS.bwidth-VisualJS.setup.margin,l={};a.innerHTML=e,a.style.display="block";var r=a.clientWidth/2;l.x=t-r,l.y=i-a.clientHeight-5,t+r>n?l.x-=t+r-n:l.x<VisualJS.setup.margin&&(l.x+=VisualJS.setup.margin-l.x),l.y<VisualJS.setup.margin&&(l.y+=1.75*a.clientHeight),a.style.left=l.x+"px",a.style.top=l.y+"px"},v=function(){var e=document;if(!e.getElementById(VisualJS.setup.tooltipid)){var t=e.createElement("div");t.id=VisualJS.setup.tooltipid,t.style.display="none",e.body.appendChild(t)}};if("cmap"===e.type)if(r)document.getElementById(VisualJS.id).innerHTML="<p>"+t.i18n.text.oldbrowser[g.lang]+"</p>";else{if("string"!=typeof e.by)return;b(t.lib.maps,!0),b(t.lib.d3,!0),b(t.map[e.by],!0),VisualJS.chart=function(){var i=h(),a=VisualJS.map[e.by],r=a.area[0],s=a.area[1],o="object"==typeof e.grouped&&"object"==typeof e.grouped.label&&e.grouped.label.length>0&&e.data[0].hasOwnProperty("group"),u=e.data[0].hasOwnProperty("val"),d=o?e.grouped.label.length:u?t.colors.map.max:1,f=t.colorclassprefix,y=VisualJS.func.colors(t.colors.map.base,d,"fill",f,o&&"object"==typeof e.grouped.color&&e.grouped.color.length===e.grouped.label.length?e.grouped.color:[],VisualJS.id),b=d3.select(p),V=d3.geo[a.projection](),v="object"==typeof a.center&&"function"==typeof V.center?V.center(a.center):V,w=v.scale(a.scale).translate([r/2,s/2]),k=d3.geo.path().projection(w),j=d3.select("#"+t.tooltipid);(c=function(){if(b.html("<"+n+"></"+n+"><"+l+"></"+l+">"),d3.select(p+" "+n).html(i),d3.select(p+" "+l).html(m(e.footer||"")),VisualJS.getSize(VisualJS.id)){var c,h,V,v,w,E=VisualJS.id,M=d3.map(),I=d3.map(),W=e.data[0].hasOwnProperty("label"),z=[],B=function(){},O=function(){},T=VisualJS.height/s,$=VisualJS.width/r,L=Math.min(Math.round(r*T),VisualJS.width),q=Math.min(Math.round(s*$),VisualJS.height),H=Math.floor((VisualJS.width-L)/2),A=Math.floor((VisualJS.height-q)/2),N=$>T?T:$,F=b.insert("svg:svg",l).attr("width",L).attr("height",q);o?(c=d3.map(),B=function(e,t){e.set(t.id,t.group)},V=function(e,t,i){return f+(e.get(i[a.id])-1)},h=function(t,i){var n=e.grouped.label[t.get(i[a.id])-1],l=W?I.get(i[a.id]):i[a.label];return"undefined"!=typeof n&&(l+=" <em>"+n+"</em>"),l}):(u?(V=function(e,t,i,n,l){var r=t.get(i[a.id]);if("undefined"==typeof r)return"";if(n===l)return f+(d/2).toFixed(0);var s=d3.scale.quantize().domain([n,l]).range(d3.range(d).map(function(e){return f+e}));return s(r)},O=VisualJS.func.legend):V=function(e,t,i){return""!==t.get(i[a.id])?"":f+(d-1)},h=function(e,t){return W?I.get(t[a.id]):t[a.label]});for(var P=0,C=e.data,D=C.length;D>P;P++){var Y=C[P];Y.hasOwnProperty("val")?null!==Y.val&&(M.set(Y.id,Y.val),z.push(Y.val)):M.set(Y.id,""),W&&I.set(Y.id,Y.label),B(c,Y)}z.sort(function(e,t){return e-t});var U=z[0],X=z[D-1];if("number"==typeof g.range?(v=d3.quantile(z,g.range),w=d3.quantile(z,1-g.range)):(v=g.range[0],w=g.range[1]),F.style("margin-left",H+"px"),F.style("margin-top",A+"px"),F.style("margin-bottom",A+"px"),F.append("svg:g").attr("class",t.areaclass).attr("transform","scale("+N+")").selectAll("path").data(a.features).enter().append("svg:path").attr("class",function(e){return""===e.properties[a.id]||""===e.properties[a.label]||!u&&"undefined"==typeof M.get(e.properties[a.id])?f+"nohover":V(c,M,e.properties,v,w)}).attr("d",k).on("mousemove",function(e){""!==e.properties[a.id]&&""!==e.properties[a.label]&&(u||o||"undefined"!=typeof M.get(e.properties[a.id]))&&x(S(E,h(c,e.properties),M.get(e.properties[a.id])),d3.event.pageX,d3.event.pageY)}).on("mouseout",function(){return j.style("display","none")}),"undefined"!=typeof U){var R=[S(E,null,v),S(E,null,w)],G=[y[y.length-1],y[0]],K=[U>v||J(v,E)===J(U,E),w>X||J(w,E)===J(X,E)];VisualJS.pub[VisualJS.id].legend={color:G,text:R,symbol:[K[0]?"==":"<=",K[1]?"==":">="]},g.legend&&"object"==typeof a.legend&&O(R,G,F,j,a.area,a.legend,K)}VisualJS.pub[VisualJS.id].heading=i}})()}}else{var w;b(t.lib.jquery,!0)?(w=!1,b(t.lib.jquery.flot,!1)):w=b(t.lib.jquery.flot,!0)?!1:!0,r&&b(t.lib.excanvas,!0);var k,j,E,M,I,W,z,B=function(){},O=[],T=[],L=[],q=e.stacked||!1,H=function(){if(g.autoheading){var i,a,n,l,r,s,o=e.time.length,u=e.data.length;if(null===e.data[0].val[0]){for(a=0,l=!0,r=[];o>a;a++){for(i=0;u>i;i++)l=l&&null===e.data[i].val[a];if(!l)break;r.push(l)}for(s=r.length,n=0;s>n;n++)if(r[n])for(e.time.shift(),i=0;u>i;i++)e.data[i].val.shift();o=e.time.length}if(null===e.data[0].val[o-1]){for(a=o,l=!0,r=[];a--;){for(i=0,u=e.data.length;u>i;i++)l=l&&null===e.data[i].val[a];if(!l)break;r.push(l)}for(n=r.length;n--;)if(r[n])for(e.time.pop(),i=0;u>i;i++)e.data[i].val.pop()}}var d=function(){};return q?b(t.lib.jquery.flot.stack,w):"tsbar"===e.type&&(b(t.lib.jquery.flot.orderbars,w),d=function(e){return e.bars}),B=function(t,i){VisualJS.ticks=[];var a,n;for(a=0,n=i.length;n>a;a++)T.push([a,i[a]]),VisualJS.ticks.push([a,i[a]]);for(a=0,n=t.length;n>a;a++){for(var l=[],r=t[a].val,s=r.length,o=0;s>o;o++)l.push([o,r[o]]);O.push("tsbar"!==e.type||q||1===n?{label:t[a].label,data:l}:{label:t[a].label,data:l,bars:{show:!0,barWidth:.2,order:a+1,lineWidth:2}})}var u=O.length;for(a=0;u>a;a++)L.push({data:O[a].data,label:O[a].label,bars:d(O[a]),shadowSize:g.grid.shadow});j=u>1},h()};switch(Array.max=function(e){return Math.max.apply(Math,e)},e.type){case"pyram":b(t.lib.jquery.flot.pyramid,w),I=!1,W=!1,z=h(),B=function(e,t,i){k=Math.max(Array.max(e[0].val),Array.max(e[1].val)),O[0]={label:e[0].label,data:[],pyramid:{direction:"L"}},O[1]={label:e[1].label,data:[]};for(var a=0,n=i.length;n>a;a++)O[0].data[a]=[i[a],e[0].val[a]],O[1].data[a]=[i[a],e[1].val[a]]},j=!0,E=!1,q=!1,M=!1;break;case"rank":var A=[];M=!1,I=!1,W=!0,z=h(),B=function(e){for(var t=[],i=0,a=e.length;a>i;i++){T[i]=[i,e[a-i-1][0]];var n=e[a-i-1][1];t.push(n),A[i]=[n,i]}O={data:A},k=Array.max(t)},j=!1,E=!1;break;case"bar":b(t.lib.jquery.flot.categories,w),I=!1,W=!0,z=h(),M=!1,B=function(e,t,i){var a,n;if("object"!=typeof i||null===i)for(n=e.length,a=0;n>a;a++)null!==e[a][1]&&O.push(["<span>"+e[a][0]+"</span>",e[a][1]]);else if("number"==typeof e[0])for(n=i.length,a=0;n>a;a++)null!==e[a]&&O.push(['<span">'+i[a]+"</span>",e[a]]);j=O.length>1},E=!0;break;case"tsline":z=H(),E=null,I=!0,W=!1,M=!0;break;case"tsbar":z=H(),E=!0,I=!1,W=!0,M=!1}VisualJS.chart=function(){B(e.data,e.time,e.by),$.fn.UseTooltip=function(i){var a=[];$(this).bind("plothover",function(n,l,r){if(r){if(a!=[r.seriesIndex,r.dataIndex]){a=[r.seriesIndex,r.dataIndex];var s=r.datapoint[0],o=r.datapoint[1],u="bar"!==e.type?r.series.label:O[s][0],d="rank"!==e.type?u:T[o][1],c="rank"!==e.type&&"bar"!==e.type?q||1===O.length?T[s][1]:"pyram"===e.type?O[l.x<0?0:1].data[r.dataIndex][0]:T[r.dataIndex][1]:!1,p="pyram"===e.type?Math.abs(s):"rank"!==e.type?"tsbar"!==e.type?o:q||1===O.length?O[r.seriesIndex].data[s][1]:o:s;x(S(i,c?d+" ("+c+")":d,p),l.pageX,l.pageY)}}else $("#"+t.tooltipid).hide(),a=[]})},j=g.legend&&j;var i={colors:t.colors.series,series:{stack:E,bars:{show:W,barWidth:.7,align:"center",fill:.9},lines:{show:M,lineWidth:g.grid.line},points:{show:I,radius:g.grid.point}},legend:{show:j},grid:{borderWidth:g.grid.border,hoverable:!0,clickable:!1,mouseActiveRadius:10},xaxis:{show:g.axis.x},yaxis:{show:g.axis.y}};(c=function(){var a,r=VisualJS.id,s=T.length;if($(p).html("<"+n+"></"+n+"><"+l+"></"+l+">"),$(p+" "+n).html(z),$(p+" "+l).html(m(e.footer||"")),VisualJS.getSize(r)){switch($(p+" "+n).after('<div class="'+t.canvasclass+" "+VisualJS.visualsize+'" style="width: '+VisualJS.width+"px; height: "+VisualJS.height+'px;"></div>'),e.type){case"pyram":i.series.pyramid={show:!0,barWidth:1},i.yaxis.show=VisualJS.height/O[0].data.length>11?g.axis.y:!1,i.xaxis.max="number"==typeof g.range?k*g.range:g.range[1],i.xaxis.tickFormatter=function(e){return J(e,r)},$.plot(f,O,i);break;case"rank":i.series.bars.horizontal=!0,i.yaxis.ticks=VisualJS.height/s>11?T.slice(0):0,"number"==typeof g.range?i.xaxis.max=k*g.range:(i.xaxis.min=g.range[0],i.xaxis.max=g.range[1]),i.xaxis.tickFormatter=function(e){return J(e,r)},i.yaxis.autoscaleMargin=0,i.series.bars.barWidth=.5,$.plot(f,[O],i);break;case"bar":i.xaxis.mode="categories",i.xaxis.tickLength=0,i.yaxis.tickFormatter=function(e){return J(e,r)},"number"!=typeof g.range&&null!==g.range&&(i.yaxis.min=g.range[0],i.yaxis.max=g.range[1]),$.plot(f,[O],i);break;case"tsline":i.grid.markings=[{color:"#999",lineWidth:.5,yaxis:{from:0,to:0}}];case"tsbar":i.yaxis.tickFormatter=function(e){return J(e,r)};var o=VisualJS.width/s,u=[],d="01";switch("number"!=typeof g.range&&null!==g.range&&(i.yaxis.min=g.range[0],i.yaxis.max=g.range[1]),VisualJS.ticks[0][1].length){case 4:if(30>o){var c=o>15?2:o>8?3:4;for(a=0;s>a;a++)u[a]=a%c?[T[a][0],""]:[T[a][0],T[a][1]];i.xaxis.ticks=u}else i.xaxis.ticks=T;break;case 5:d="1";case 6:if(35>o){for(a=0;s>a;a++)u[a]=VisualJS.ticks[a][1].slice(4)!==d?[VisualJS.ticks[a][0],""]:[VisualJS.ticks[a][0],VisualJS.ticks[a][1].slice(0,4)],T[a][1]=V(VisualJS.ticks[a][1],VisualJS.id);i.xaxis.ticks=u}else{for(a=0;s>a;a++)T[a][1]=V(VisualJS.ticks[a][1],VisualJS.id);i.xaxis.ticks=T}break;default:i.xaxis.ticks=T}$.plot(f,L,i)}$(f).UseTooltip(VisualJS.id),VisualJS.pub[VisualJS.id].heading=z}})()}}VisualJS.scripts.length&&"object"==typeof LazyLoad?LazyLoad.js(VisualJS.scripts,y):y()}};if("function"!=typeof visual)var visual=VisualJS.load;